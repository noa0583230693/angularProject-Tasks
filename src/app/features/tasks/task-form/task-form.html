<form [formGroup]="form" (ngSubmit)="submit()" class="task-form">
  <h3 class="form-title">{{ isEditMode() ? '✏️ עדכן משימה' : '➕ משימה חדשה' }}</h3>

  <div class="form-group">
    <label for="title">כותרת <span class="required">*</span></label>
    <input 
      id="title"
      type="text" 
      formControlName="title"
      placeholder="הקלד כותרת הצ משימה"
      class="form-input" />
    @if (form.get('title')?.touched && form.get('title')?.invalid) {
      <small class="error-msg">
        @if (form.get('title')?.errors?.['required']) {
          כותרת המשימה היא שדה חובה
        }
        @if (form.get('title')?.errors?.['minlength']) {
          כותרת המשימה חייבת להכיל לפחות 3 תווים
        }
      </small>
    }
  </div>

  <div class="form-group">
    <label for="description">תיאור</label>
    <textarea 
      id="description"
      formControlName="description"
      placeholder="הכנס תיאור למשימה..."
      class="form-textarea"></textarea>
  </div>

  <div class="form-row">
    <div class="form-group">
      <label for="status">סטטוס</label>
      <select id="status" formControlName="status" class="form-select">
        @for (s of statuses; track s) {
          <option [value]="s">
            {{ s === 'TODO' ? '⬜ לא החל' : s === 'IN_PROGRESS' ? '🟦 בתהליך' : '✅ הסתיים' }}
          </option>
        }
      </select>
    </div>

    <div class="form-group">
      <label for="priority">עדיפות</label>
      <select id="priority" formControlName="priority" class="form-select">
        @for (p of priorities; track p) {
          <option [value]="p">
            {{ p === 'LOW' ? '🟢 נמוכה' : p === 'MEDIUM' ? '🟡 בינונית' : '🔴 גבוהה' }}
          </option>
        }
      </select>
    </div>
  </div>

  <div class="form-group">
    <label for="assigneeId">👤 משוייך ל</label>
    <input 
      id="assigneeId"
      type="number" 
      formControlName="assigneeId"
      placeholder="הכנס ID של המשתמש"
      class="form-input" />
  </div>
    

  <div class="form-actions">
    <button type="submit" [disabled]="form.invalid" mat-raised-button color="primary" class="btn-submit">
      💾 {{ isEditMode() ? 'עדכן' : 'הוסף' }}
    </button>
    <button type="button" (click)="cancel.emit()" mat-stroked-button class="btn-cancel">
      ❌ ביטול
    </button>
  </div>
</form>
